/*!


   *                *   
   **               ***
   ****             ***
   *****            ***     
   *******          ***
   *********        ***
   **********       ***
   ************     ***
   *************.   ***
   ***************  ***


 * LifeJS Game Engine v1.0.8
 * https://github.com/rhpo/life.js
 *
 * Author: Ramy Hadid
 *
 * Copyright (C) 2022 LifeJS. All rights reserved.
 * Released under the MIT license
 * Licence: Copyright 2022 ODromo.
 *
 * Permission is hereby granted, free of charge, to any  person  obtaining  a  copy  of  this  software
 * and associated documentation files (the "Software"), to deal in  the  Software  without  restriction,
 * including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense,
 * and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:

 * The above copyright notice and this permission  notice shall be included in all copies or substantial
 * portions of the Software.

 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT  NOT
 * LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
 * NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES  OR  OTHER  LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR  IN  CONNECTION  WITH  THE
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * Date: Mon Sep 05 2022 17:59:03 GMT+0100 (GMT+02:00)
 *
 * #free_palestine  ðŸ‡µðŸ‡¸
 * #free_ukraine    ðŸ‡ºðŸ‡¦
 *
 * ï·½
*/

export const id=()=>Math.random().toString(36).substring(2,9),randName=()=>{let t="James.Robert.John.Michael.David.William.Richard.Thomas.Charles.Islam.Mohammed.Ramy".split(".");return t[Math.floor(Math.random()*t.length)]},defined=t=>null!=t,deg=Math.PI/180;export const Shapes={Circle:"circle",Square:"rectangle",Rectangle:"rectangle",Rect:"rectangle",Line:"line",Dot:"dot"};export const PreSuffixedRange=(t="",e="",i=0,s)=>{let r={};for(let o=i;o<=s;o++)r[o]=t+o+e;return r};export const Patterns={Image:"image",Color:"color",SolidColor:"color",Gradient:"gradient"};export const Events={MouseDown:"mousedown",MouseUp:"mouseup",MouseMove:"mousemove",MouseEnter:"mouseenter",MouseLeave:"mouseleave",Hover:"hover",UnHover:"unhover",Click:"click",DoubleClick:"dblclick"};export const Cursors={Default:"default",Pointer:"pointer",Crosshair:"crosshair",Move:"move",Text:"text",Wait:"wait",Help:"help",Progress:"progress",NotAllowed:"not-allowed",NoDrop:"no-drop",Grab:"grab",Grabbing:"grabbing",AllScroll:"all-scroll",ZoomIn:"zoom-in",ZoomOut:"zoom-out",Cell:"cell",ContextMenu:"context-menu",Alias:"alias",Copy:"copy",ColResize:"col-resize",RowResize:"row-resize",NoDrop:"no-drop",None:"none",EResize:"e-resize",NResize:"n-resize",NeResize:"ne-resize",NwResize:"nw-resize",SResize:"s-resize",SeResize:"se-resize",SwResize:"sw-resize",WResize:"w-resize",EwResize:"ew-resize",NsResize:"ns-resize",NeswResize:"nesw-resize",NwseResize:"nwse-resize"};export class GameLoop{constructor(t,e=60){var i,s=1e3/e,r=null,o=-1,h=t;function n(t){null===r&&(r=t);var e=Math.floor((t-r)/s);e>o&&h({time:t,frame:o=e}),i=requestAnimationFrame(n)}this.isPlaying=!1,this.frameRate=function(t=60){if(!arguments.length)return e;s=1e3/(e=t),o=-1,r=null},this.start=function(){this.isPlaying||(this.isPlaying=!0,i=requestAnimationFrame(n))},this.pause=function(){this.isPlaying&&(cancelAnimationFrame(i),this.isPlaying=!1,r=null,o=-1)},gameLoops.push(this)}start(){this.start()}pause(){this.pause()}setFPS(t){this.frameRate(t)}setCallback(t){this.callback=t}setMainFunction(t){this.mainFunc=t}}let world={},gameLoops=[];const eventify=t=>{t.events={},t.on=t.addEventListener=function(e,i){"object"!=typeof t.events[e]&&(t.events[e]=[]),t.events[e].push(i)},t.removeListener=t.removeEventListener=function(e,i){let s;"object"==typeof t.events[e]&&(s=t.events[e].indexOf(i),s>-1&&t.events[e].splice(s,1))},t.emit=function(e){var i,s,r,o=[].slice.call(arguments,1);if("object"==typeof t.events[e])for(r=(s=t.events[e].slice()).length,i=0;i<r;i++)s[i].apply(t,o)},t.once=function(e,i){t.on(e,(function s(){t.removeListener(e,s),i.apply(t,arguments)}))}};export class World{constructor(t={canvas:null,doc:document,G:{x:0,y:.001},pattern:"color",background:"#000",size:{width:window.innerWidth,height:window.innerHeight},hasLimits:!0,tag:"map",border:{width:1,background:"#000",pattern:"color"},sprites:{},onmousemove:null,onclick:null,onmouseup:null,rotation:0,paused:!1,createWorld:!0,allowContextMenu:!1,cursor:"default"}){if(eventify(this),this.canvas=t.canvas||null,this.createWorld=!defined(t.createWorld)||t.createWorld,this.isTouchDevice=this.isMobile="ontouchstart"in document.documentElement||!!window.navigator.msMaxTouchPoints,this.allowContextMenu=!!defined(t.allowContextMenu)&&t.allowContextMenu,this.doc=t.doc||document,this.cursor=defined(t.cursor)?t.cursor:"default",this.G=t.G||{x:0,y:.001},this.pattern=t.pattern||"color",this.background=t.background||"#000",this.color=t.color||"#fff",this.size=t.size||{width:window.innerWidth,height:window.innerHeight},this.hasLimits=!defined(t.hasLimits)||t.hasLimits,this.tag=t.tag||"map",this.border=t.border||{width:8,background:"#000",pattern:"color"},this.sprites=this.sprites||{},this.G=t.G||{x:0,y:.001},this.Objects=[],this.keys={},this.set=(t,e)=>this[t]=e,this.responsive=void 0===t.responsive||t.responsive,this.paused=void 0!==t.paused&&t.paused,this.rotation=void 0!==t.rotation?t.rotation:0,this.borderY={type:"rectangle",pattern:this.border.pattern,background:this.border.background,width:this.border.width,height:this.size.height,x:0,y:0,tag:"border",border:this.border,name:"borderY"},this.borderX={type:"rectangle",pattern:this.border.pattern,background:this.border.background,width:this.size.width,height:this.border.width,x:0,y:0,tag:"border",name:"borderX",border:this.border},this.borderYW={type:"rectangle",pattern:this.border.pattern,background:this.border.background,width:this.border.width,height:this.size.height,x:this.size.width-this.border.width,y:0,tag:"border",border:this.border,name:"borderYW"},this.borderXW={type:"rectangle",pattern:this.border.pattern,background:this.border.background,width:this.size.width,height:this.border.width,x:0,y:this.size.height-this.border.width,tag:"border",name:"borderXW",border:this.border},this.createWorld){if(this.canvas||(this.canvas=this.doc.createElement("canvas"),this.canvas.width=this.size.width,this.canvas.height=this.size.height,this.doc.body.appendChild(this.canvas)),this.responsive){const t=()=>{this.width=window.innerWidth,this.height=window.innerHeight,this.canvas.width=this.width,this.canvas.height=this.height};window.addEventListener("resize",t)}return this.canvas.oncontextmenu=t=>!this.allowContextMenu&&t.preventDefault(),!0===this.hasLimits&&[this.borderX,this.borderY,this.borderXW,this.borderYW].forEach((t=>{this.register(new Shape({...t,name:t.name,physics:!1}))})),this.onLoad=t=>window.addEventListener("load",t),this.onLoad((()=>{this.hasLimits===this.responsive==!0&&window.addEventListener("resize",(()=>{this.getElementByName("borderY").setProps({width:this.border.width,height:this.height}),this.getElementByName("borderX").setProps({width:this.canvas.width,height:this.border.width}),this.getElementByName("borderYW").setProps({width:this.border.width,height:this.canvas.height,x:this.canvas.width-this.border.width}),this.getElementByName("borderXW").setProps({width:this.canvas.width,height:this.border.width,y:this.canvas.height-this.border.width})}))})),this.canvas.addEventListener("click",(t=>this.emit("click",t))),this.doc.addEventListener("keydown",(t=>{this.keys[t.key]=!0})),this.doc.addEventListener("keyup",(t=>{this.keys[t.key]=!1})),this.tag=this.tag||"map",Object.keys(this.sprites).forEach(((t,e)=>{this.sprites[t]={},this.sprites[t].image=new Image,this.sprites[t].image.src=this.sprites[t].src,this.sprites[t].image.decode().then((()=>{this.sprites[t].width=this.sprites[t].image.width,this.sprites[t].height=this.sprites[t].image.height}))})),this.mouse={x:0,y:0,isLeftClicked:!1,isRightClicked:!1,isMiddleClicked:!1},this.canvas.addEventListener("mousemove",(t=>{this.mouse.x=t.offsetX,this.mouse.y=t.offsetY})),this.canvas.addEventListener("mousedown",(t=>{0===t.button&&(this.mouse.isLeftClicked=!0),1===t.button&&(this.mouse.isMiddleClicked=!0),2===t.button&&(this.mouse.isRightClicked=!0)})),this.canvas.addEventListener("mouseup",(t=>{0===t.button&&(this.mouse.isLeftClicked=!1),2===t.button&&(this.mouse.isRightClicked=!1),1===t.button&&(this.mouse.isMiddleClicked=!1)})),this.mousedown=t.mousedown||(()=>{}),this.mouseup=t.mouseup||(()=>{}),this.mousemove=t.mousemove||(()=>{}),this.canvas.addEventListener("mousedown",(t=>this.mousedown(t))),this.canvas.addEventListener("mouseup",(t=>this.mouseup(t))),this.canvas.addEventListener("mousemove",(t=>this.mousemove(t))),world=this,this.ctx=this.canvas.getContext("2d"),this.width=this.canvas.width,this.height=this.canvas.height,this.emit("load"),this.canvas.addEventListener("mousemove",(t=>{this.HoveredObjects().forEach((e=>{e.emit("mousemove",t),e.hovered||(e.hovered=!0,e.emit("hover",t),e.emit("mouseenter",t))})),this.UnhoveredObjects().forEach((e=>{e.emit("mousemove",t),e.hovered&&(e.hovered=!1,e.emit("unhover",t),e.emit("mouseleave",t))}))})),this.canvas.addEventListener("mousedown",(t=>{this.HoveredObjects().forEach((e=>{e.clicked||(e.clicked=!0,e.emit("mousedown",t))}))})),this.canvas.addEventListener("mouseup",(t=>{this.HoveredObjects().forEach((e=>{e.emit("mouseup",t),e.emit("click",t),e.clicked&&(e.clicked=!1)}))})),this.canvas.addEventListener("touchstart",(t=>{this.HoveredObjects().forEach((e=>{e.clicked||(e.clicked=!0,e.emit("touchstart",t))})),this.mouse.isLeftClicked=!0})),this.canvas.addEventListener("touchend",(t=>{this.HoveredObjects().forEach((e=>{e.emit("touchend",t),e.emit("click",t),e.clicked&&(e.clicked=!1)})),this.emit("touchend",t),this.mouse.isLeftClicked=!1})),this.canvas.addEventListener("touchmove",(t=>{this.HoveredObjects().forEach((e=>{e.emit("touchmove",t)})),this.mouse.x=t.touches[0].clientX,this.mouse.y=t.touches[0].clientY})),this.canvas.addEventListener("dblclick",(t=>{this.HoveredObjects().forEach((e=>{e.emit("dblclick",t)}))})),this}}on;emit;addEventListener;removeEventListener;removeListener;key={isPressed:t=>this.keys[t]};destroy(){this.canvas&&this.canvas.remove(),this.Objects=[],gameLoops.forEach((t=>{t.pause()}))}register(t){this.Objects.push(t)}unregister(t){this.Objects.forEach(((e,i)=>e.id===t.id&&this.Objects.splice(i,1)))}setCursor(t){this.canvas.style.cursor=t,this.cursor=t}center(t,e=!1){t.x=this.canvas.width/2-t.width/2,t.y=this.canvas.height/2-t.height/2,e&&(t.velocity={x:0,y:0})}centerX(t,e=!1){t.x=this.canvas.width/2-t.width/2,e&&(t.velocity={x:0,y:0})}centerY(t,e=!1){t.y=this.canvas.height/2-t.height/2,e&&(t.velocity={x:0,y:0})}getAngleBetween(t,e){return 180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI}draw(t={type:"rectangle",background:"#000",pattern:"color",radius:50,width:50,height:50,x:this.canvas.width/2,y:this.canvas.height/2,rotation:0,x1:this.canvas.width/2,y1:this.canvas.height/2,x2:this.canvas.width/2,y2:this.canvas.height/2}){switch(t.type=t.type||"rectangle",t.background=t.background||"#000",t.pattern=t.pattern||"color",t.radius=t.radius||void 0,t.width=t.radius||t.width||50,t.height=t.radius||t.height||50,t.x=defined(t.x)?t.x:this.canvas.width/2,t.y=defined(t.y)?t.y:this.canvas.height/2,t.rotation=defined(t.rotation)?t.rotation:0,t.x1=defined(t.x1)?t.x1:0,t.y1=defined(t.y1)?t.y1:0,t.x2=defined(t.x2)?t.x2:this.canvas.width/2,t.y2=defined(t.y2)?t.y2:this.canvas.height/2,this.ctx.save(),this.ctx.translate(t.x,t.y),this.ctx.rotate(t.rotation),t.type){case"rectangle":switch(t.pattern){case"color":this.ctx.fillStyle=t.background,this.ctx.fillRect(t.x,t.y,t.width,t.height);break;case"image":this.ctx.drawImage(t.image,0,0,t.width,t.height);break}break;case"circle":switch(t.pattern){case"color":this.ctx.fillStyle=t.background,this.ctx.beginPath(),this.ctx.arc(0,0,t.radius,0,2*Math.PI),this.ctx.fill();break;case"image":this.ctx.drawImage(t.image,-t.radius,-t.radius,2*t.radius,2*t.radius);break}break;case"dot":switch(t.pattern){case"color":this.ctx.fillStyle=t.background,this.ctx.beginPath(),this.ctx.arc(0,0,t.radius,0,2*Math.PI),this.ctx.fill();break;case"image":this.ctx.drawImage(t.image,-t.radius,-t.radius,2*t.radius,2*t.radius);break}break;case"line":this.ctx.strokeStyle=t.background,this.ctx.beginPath(),this.ctx.moveTo(t.x1-world.width/2,t.y1-world.height/2),this.ctx.lineTo(t.x2-world.width/2,t.y2-world.height/2),this.ctx.stroke();break}this.ctx.restore()}collision(t,e){return e instanceof Array?e.some((e=>this.collision(t,e))):t instanceof Array?t.some((t=>this.collision(t,e))):t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}isTouchingLimits(t){return t.x+t.width>0&&t.x<world.width&&t.y+t.height>0&&t.y<world.height}getAllElements(){return this.Objects}getElementsByTagName(t){return this.Objects.filter((e=>e.tag===t))}getElementByName(t){return this.Objects.find((e=>e.name===t))}getElementByTagName(t){return this.Objects.find((e=>e.tag===t))}getElementsByName(t){return this.Objects.filter((e=>e.name===t))}getElementsByType(t){return this.Objects.filter((e=>e.type===t))}preventCollision(t,e){if("object"==typeof e&&e instanceof Array)e.forEach((e=>t.isBody&&e.isBody&&this.preventCollision(t,e)));else if(t.id===e.id||t.noCollisionWith.includes(e.tag)||e.noCollisionWith.includes(t.tag)||!this.collision(t,e))!this.collision(t,e)&&e.CCHas(t)&&(t.finishCollideWith(e),e.finishCollideWith(t),t.emit("finishcollision",e),e.emit("finishcollision",t),t.onFinishCollision(e,t),e.onFinishCollision(t,e));else{switch("border"!==t.tag&&"border"!==e.tag&&(t.CCHas(e)||(t.onCollision(e,t),e.onCollision(t,e),t.emit("collision",e),e.emit("collision",t),t.collideWith(e),e.collideWith(t))),t.cacheDirection){case"down":t.y+t.height>e.y&&(t.y=e.y-t.height,t.velocity.x=t.velocity.x*t.friction);break;case"up":t.y<e.y+e.height&&(t.y=e.y+e.height,t.velocity.x=t.velocity.x*t.friction);break;case"left":t.x<e.x+e.width&&(t.x=e.x+e.width);break;case"right":t.x+t.width>e.x&&(t.x=e.x-t.width);break}if(t.physics)switch(t.cacheDirection){case"left":case"right":var i=~~(-t.velocity.x*t.rebound);t.velocity.x=i;break;case"up":case"down":i=~~(-t.velocity.y*t.rebound);t.velocity.y=i,t.cacheDirection=t.velocity.y<0?"down":"up",0===i&&(t.cacheDirection="down");break}}}update(t=null,e=null){if(!this.paused){switch(this.ctx.clearRect(0,0,this.width,this.height),!this.canvas.style.cursor!==this.cursor&&(this.canvas.style.cursor=this.cursor),this.pattern){case"color":this.draw({pattern:"color",background:this.background,x:0,y:0,width:this.width,height:this.height});break;case"image":this.draw({pattern:"image",image:this.background.image,x:0,y:0,width:this.width,height:this.height});break}t&&t(),this.Objects=this.Objects.sort(((t,e)=>"wall"===t.tag?-1:"wall"===e.tag?1:t.zIndex-e.zIndex)),this.Objects.forEach((t=>{if(t.physics){if(this.getElementsByType("border").some((e=>this.collision(t,e))))switch(t.velocity.y=0,t.velocity.x=0,t.cacheDirection){case"down":t.cacheDirection="up";break;case"up":break;case"left":t.cacheDirection="right";break;case"right":t.cacheDirection="left";break}else t.velocity.x+=this.G.x,t.velocity.y+=this.G.y;t.x+=t.velocity.x,t.y+=t.velocity.y,t.cacheDirection=t.velocity.x<0?"right":"left",t.cacheDirection=t.velocity.y<0?"up":"down",world.preventCollision(t,world.Objects)}t.draw()})),e&&e()}}pause(){this.paused=!0}resume(){this.paused=!1}getCursorPosition(){return{x:this.mouse.x,y:this.mouse.y}}generateMap(t,e){let i={};return t.forEach(((s,r)=>{s.split("").forEach(((o,h)=>{const n=s.length;e[o]&&(i[o]||(i[o]=[]),i[o].push(e[o]({mapWidth:world.width,mapHeight:world.height,x:h*(world.width/n),y:r*(world.height/t.length),width:world.width/n,height:world.height/t.length,Cindex:h,Lindex:r})))}))})),i}HoveredObjects(){return world.Objects.filter((t=>t.x<this.mouse.x&&t.x+t.width>this.mouse.x&&t.y<this.mouse.y&&t.y+t.height>this.mouse.y))}UnhoveredObjects(){return world.Objects.filter((t=>t.x>this.mouse.x||t.x+t.width<this.mouse.x||t.y>this.mouse.y||t.y+t.height<this.mouse.y))}getEmptySpace(t){const e=[];let i=[];this.Objects.forEach((t=>{"border"!==t.tag&&"emptySpace"!==t.tag&&"player"!==t.tag&&i.push({x:t.x,y:t.y,width:t.width,height:t.height})})),t&&i.forEach((e=>{e.x===t.x&&e.y===t.y&&i.splice(i.indexOf(e),1)})),i.forEach((t=>{const i=t.x,s=t.y,r=i+t.width,o=s+t.height,h={start:i,end:r},n={start:i,end:r},a={start:s,end:o},d={start:s,end:o};e.push(h),e.push(n),e.push(a),e.push(d)})),e.sort(((t,e)=>t.start-e.start))}oncePressed(t,e){window.addEventListener("keyup",(i=>t===i.key&&e()))}}export class Shape{constructor(t={type:"rectangle",x:0,y:0,width:10,height:10,zIndex:0,isBody:!0,pattern:"color",background:"",name:"Example",rotation:0,name:randName(),tag:"unknown",onCollision:()=>{},onFinishCollision:()=>{},physics:!0,rebound:.9,friction:.5,id:id(),speed:3,velocity:{x:0,y:0},border:{background:"blue",width:2},animate:!0,flip:[],opacity:1,hovered:!1,clicked:!1,noCollisionWith:[],lineCoordinates:{x1:0,y1:0,x2:0,y2:0},zIndex:9999,scale:1},e=!1){if(!world)throw new Error("BrainError: No world is initialized!");return eventify(this),this.type=t.type||"rectangle",this.zIndex=defined(t.zIndex)?t.zIndex:0,this.flip=defined(t.flip)?t.flip:{x:!1,y:!1},this.opacity=defined(t.opacity)?t.opacity:1,this.hovered=!1,this.clicked=!1,this.background=t.color||"black",this.x=t.x||0,this.y=t.y||0,this.noCollisionWith=defined(t.noCollisionWith)?"string"==typeof t.noCollisionWith?[t.noCollisionWith]:t.noCollisionWith:[],this.radius=t.radius,defined(this.radius)?(this.width=this.radius,this.height=this.radius):(this.width=t.width||10,this.height=t.height||10),this.isBody=!defined(t.isBody)||t.isBody,this.animate=!defined(t.animate)||t.animate,this.pattern=t.pattern||"color",this.background=t.background||"",this.rotation=t.rotation||0,this.name=defined(t.name)?t.name:randName(),this.lineCoordinates=t.lineCoordinates||{x1:0,y1:0,x2:0,y2:0},this.tag=t.tag||"unknown",this.onCollision=t.onCollision||(()=>{}),this.onFinishCollision=t.onFinishCollision||(()=>{}),this.collisionObjects=[],this.physics=!defined(t.physics)||t.physics,this.rebound=defined(t.rebound)?t.rebound:.7,this.friction=defined(t.friction)?t.friction:.5,this.border=defined(t.border)?t.border:{background:"transparent",width:0},this.id=id(),this.cacheDirection="up",this.speed=t.speed||3,this.velocity=t.velocity||{x:0,y:0},this.scale=defined(t.scale)?t.scale:1,world.register&&!e&&world.register(this),this}on;emit;addEventListener;removeEventListener;removeListener;collideWith(t){this.collisionObjects.push(t)}finishCollideWith(t){this.collisionObjects.forEach(((e,i)=>e.id===t.id&&this.collisionObjects.splice(i,1)))}setVelocity(t,e){this.velocity.x=t,this.velocity.y=e}rotate(t){this.rotation+=t}setRotation(t){this.rotation=t}draw(){var t=world.ctx;switch(t.save(),t.translate(this.x+this.width/2,this.y+this.height/2),t.scale(this.flip.x?-1:1,this.flip.y?-1:1),t.translate(-(this.x+this.width/2),-(this.y+this.height/2)),t.translate(this.x+this.width/2,this.y+this.height/2),t.rotate(this.rotation*Math.PI/180),t.translate(-(this.x+this.width/2),-(this.y+this.height/2)),t.globalAlpha=this.opacity,this.type){case"rectangle":if("color"===this.pattern&&(world.ctx.fillStyle=this.background,world.ctx.fillRect(this.x,this.y,this.width,this.height)),"gradient"===this.pattern){if(!this.background.gradientSettings)throw new Error("ArgumentError: No gradient settings found!");if(!this.background.gradientSettings.startColor)throw new Error("ArgumentError: No start color found!");if(!this.background.gradientSettings.endColor)throw new Error("ArgumentError: No end color found!");let t=world.ctx.createGradient(this.background.gradientSettings);t.addColorStop(0,this.background.gradientStart),t.addColorStop(1,this.background.gradientEnd)}if("image"===this.pattern){if(!this.background.image)throw new Error("ArgumentError: No image found!");t.drawImage(this.background.image,this.x,this.y,this.flip.x?-this.width:this.width,this.flip.y?-this.height:this.height)}break;case"circle":world.ctx.beginPath(),world.ctx.arc(this.x+this.width/2,this.y+this.height/2,this.width/2,0,2*Math.PI),world.ctx.fillStyle=this.background,world.ctx.fill();break;case"line":world.ctx.beginPath(),world.ctx.lineWidth=this.width,world.ctx.moveTo(this.lineCoordinates.x1,this.lineCoordinates.y1),world.ctx.lineTo(this.lineCoordinates.x2,this.lineCoordinates.y2),world.ctx.strokeStyle=this.pattern||this.background,world.ctx.stroke();break;case"image":world.ctx.drawImage(this.image,this.x,this.y,this.width,this.height);break}if(this.border){world.ctx.strokeStyle=this.border.background;var e=world.ctx.lineWidth;world.ctx.lineWidth=this.border.width,world.ctx.strokeRect(this.x,this.y,this.width,this.height),world.ctx.lineWidth=e}t.restore(),world.ctx.setTransform(1,0,0,1,0,0)}remove(){world.unregister(this)}result(){return this}isOutOfMap(){return this.x<0||this.x>world.width||this.y<0||this.y>world.height}isOutOfRange(t){return this.x<t.start||this.x>t.end||this.y<t.start||this.y>t.end}get(t){return this[t]}set(t,e){return this[t]=e,this}setProps(t){for(let e in t)this[e]=t[e];return this}move(t,e=null,i=!1){this.cacheDirection=t;var s=null!==e?e:this.speed;switch(t){case"up":this.y-=s;break;case"down":this.y+=s;break;case"left":this.x-=s;break;case"right":this.x+=s;break;default:break}world.preventCollision(this,world.Objects)}moveTheta(t,e=null,i=!1){var s=defined(e)?e:this.speed;this.x+=Math.cos(t*deg)*s,this.y+=Math.sin(t*deg)*s,world.preventCollision(this,world.Objects)}follow(t){const e=t.x-this.x,i=t.y-this.y,s=Math.atan2(i,e);this.x+=Math.cos(s)*this.speed,this.y+=Math.sin(s)*this.speed,world.preventCollision(this,world.Objects)}onCollide(t){return this.onCollision=t,this}isCollidingWith(t){return world.collision(this,t)}CCHas(t){var e=!1;return this.collisionObjects.forEach((i=>i.id===t.id&&(e=!0))),e}jump(t){this.velocity.y=-t}}export class Animation{#t=()=>{};constructor(t,e=100,i=!0,...s){if(!t)throw new Error("ArgumentError: No target found!");if(!s||!s.length)throw new Error("ArgumentError: No frames found!");this.target=t,this.speed=e||100,this.frames=s,this.currentFrame=0,this.isPlaying=!0,this.#t=()=>{},setInterval((()=>{this.isPlaying&&(this.currentFrame++,this.currentFrame>=this.frames.length&&(this.currentFrame=0,i||(this.isPlaying=!1,this.#t(this.target))),this.target.background.image=this.frames[this.currentFrame])}),this.speed)}start(){return this.isPlaying=!0,this}stop(){return this.isPlaying=!1,this}onFinish(t){return this.#t=t,this}}export const stopAllSounds=t=>{Object.keys(t).forEach((e=>t[e].pause()))};export function Text(t={text:"",background:"white",font:"Arial",size:"20px",x:0,y:0,fromEnd:!1,type:"fill",zIndex:9999}){switch(t.text=t.text||"",t.background=t.background||"white",t.font=t.font||"Arial",t.size=t.size||"20px",t.x=t.x||0,t.y=t.y||0,t.type=t.type||"fill",t.fromEnd=t.fromEnd||!1,t.y=2*t.y+t.y/2+t.size.split("px")[0]/4,world.ctx.font=t.size+" "+t.font,t.type){default:case"fill":world.ctx.fillStyle=t.background,t.fromEnd?world.ctx.fillText(t.text,world.width-world.ctx.measureText(t.text).width-t.x,t.y):world.ctx.fillText(t.text,t.x,t.y);break;case"stroke":world.ctx.strokeStyle=t.background,t.fromEnd?world.ctx.strokeText(t.text,t.x-world.ctx.measureText(t.text).width,t.y):world.ctx.strokeText(t.text,t.x,t.y);break}}export function LoadImage(t){return new Promise(((e,i)=>{const s=new Image;s.onload=()=>e(s),s.src=t}))}export function LoadAudio(t){return new Promise(((e,i)=>{const s=new Audio;s.src=t,e(s)}))}export function spritesBETA(t){return new Promise((async e=>{for(let e in t)world.sprites[e]=await LoadImage(t[e]);resolve()}))}
